<div id="giscus">
  <script src="https://giscus.app/client.js"
    data-repo="encelo/giscus-comments"
    data-repo-id="R_kgDOKVQDvA"
    data-category="Announcements"
    data-category-id="DIC_kwDOKVQDvM4CZa7I"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="1"
    data-emit-metadata="1"
    data-input-position="bottom"
    data-theme="dark_dimmed"
    data-lang="en"
    crossorigin="anonymous"
    async>
  </script>
</div>

<script>
  function setGiscusTheme(theme) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage(
      { giscus: { setConfig: { theme: theme } } },
      'https://giscus.app'
    );
  }

  // Run on page load
  if (document.documentElement.classList.contains('dark')) {
    setGiscusTheme('dark_dimmed');
  }

  // If your theme toggle adds/removes a 'dark' class on <html>
  const observer = new MutationObserver(() => {
    const isDark = document.documentElement.classList.contains('dark');
    setGiscusTheme(isDark ? 'dark_dimmed' : 'light');
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['class'],
  });
</script>
